{% extends 'base.html' %}
{% load static %}
{% block css %}
    <link rel="stylesheet" href="{% static 'css/auto-probeg-page.css' %}">
    <link rel="stylesheet" href="{% static 'css/lightbox.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
{% endblock %}
{% block top-banner %}
{% endblock top-banner %}
{% block content %}
    <main class="main" style="padding: 0px 30px;">
        <section class="main-main">
            <div class="container">
                <p class="backlink-p">
                    <a href="{% url 'index' %}" class="back-link">Главная / </a>
                    {% if car.new %}
                        <a href="{% url 'index' %}"> Новые авто / </a>
                    {% else %}
                        <a href="{% url 'used_cars' %}">Авто с пробегом</a>
                    {% endif %}
                    {{ car.brand }} {{ car.model }} {{ car.generation.title }}

                </p>
                <div class="main-item">
                    <div class="main-item__imgs">
                        <div class="main-item__imgs-big">
                            <div class="stats-btns">
                                <div class="owl-carousel owl-theme">
                                    {% if car.car_images.all %}
                                        {% for image in car.car_images.all|slice:'1:'%}
                                            <div class="item">
                                                <img src="{{ image.image.url }}"
                                                     alt="{{ car.brand.title }} {{ car.model.title }} {{ car.generation.title }}">
                                            </div>
                                        {% endfor %}
                                    {% endif %}

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="main-item__info">
                        <h1 class="main-item__info-title">
                            {{ car.brand.title }} {{ car.model.title }} {{ car.generation.title }}
                        </h1>
                        <div class="main-item__info-params">
                            <div class="main-item__info-params__item">
                                <img src="{% static 'img/auto-probeg-page-1920/bak.png' %}" alt="">
                                <p style="margin: 0 auto;">{{ car.modification.volume }} л</p>
                            </div>
                            <div class="main-item__info-params__item">
                                <img src="{% static 'img/auto-probeg-page-1920/car-ls.png' %}" alt="">
                                <p style="margin: 0 auto;"> {{ car.modification.power }} л.с.</p>
                            </div>
                            <div class="main-item__info-params__item">
                                <img src="{% static 'img/auto-probeg-page-1920/kpp.png' %}" alt="">
                                <p style="margin: 0 auto;">{{ car.modification.transmission.title }}</p>
                            </div>
                            <div class="main-item__info-params__item">
                                <img src="{% static 'img/auto-probeg-page-1920/privod.png' %}" alt="">
                                {% if car.modification.drive_unit %}
                                    {% for drive in car.modification.drive_unit.all %}
                                        <p style="margin: 0 auto;">{{ drive }}</p>
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>
                        <div class="main-item__info-price">
                            <p class="main-item__info-price__main">
                                {{ car.price }} ₽
                            </p>
                            <p class="main-item__info-price__credit">
                                В кредит от 12 000 ₽/мес
                            </p>
                        </div>
                        <div class="main-item__info-btns">
                            <button class="main-item__info-btns__reserve red-btn">
                                Забронировать онлайн
                            </button>
                            <button class="main-item__info-credit">
                                Купить в кредит
                            </button>
                        </div>
                        <div class="main-item__info-total">
                            <div class="main-item__info-total__pluses">
                                <div class="main-item__info-total__pluses-item">
                                    <img src="{% static 'img/auto-probeg-page-1920/trade-in.png' %}" alt="">
                                    <p>Зачёт вашего авто в trade-in</p>
                                </div>
                                <div class="main-item__info-total__pluses-item">
                                    <img src="{% static 'img/auto-probeg-page-1920/procent.png' %}" alt="">
                                    <p>Беспроцентная рассрочка 0%</p>
                                </div>
                                <div class="main-item__info-total__pluses-item">
                                    <img src="{% static 'img/auto-probeg-page-1920/present.png' %}" alt="">
                                    <p>Доп. выгода до 200 000 ₽</p>
                                </div>
                            </div>
                            <div class="main-item__info-total__desc">
                                <p class="main-item__info-total__desc-item">
                                    Привод: {% if car.modification.drive_unit %}
                                    {% for drive in car.modification.drive_unit.all %}
                                        <span>{{ drive }}</span>
                                    {% endfor %}
                                {% endif %}
                                </p>
                                <p class="main-item__info-total__desc-item">
                                    Кузов: {% if car.modification.body_type %}
                                    {% for body in car.modification.body_type.all %}
                                        <span>{{ body }}</span>
                                    {% endfor %}
                                {% endif %}
                                </p>
                                <p class="main-item__info-total__desc-item">
                                    Год: <span>{{ car.modification.year }}</span>
                                </p>
                                <p class="main-item__info-total__desc-item">
                                    Пробег: <span>{{ car.mileage }} км.</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="main-item__mobile">
                    <div>
                        <div>
                            <h1 class="main-item__info-title">
                                {{ car.brand }} {{ car.model }} {{ car.modification.title }}
                            </h1>
                            <div class="stats-btns" style="margin-bottom: 25px;">
                                <div class="owl-carousel owl-theme">
                                    {% if car.car_images.all %}
                                        {% for image in car.car_images.all %}
                                            <div class="item">
                                                <img src="{{ image.image.url }}"
                                                     alt="{{ car.brand.title }} {{ car.model.title }} {{ car.generation.title }}">
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="main-item__info-price">
                            <p class="main-item__info-price__main">
                                {{ car.price }} ₽
                            </p>
                            <p class="main-item__info-price__credit">
                                В кредит от 12 000 ₽/мес
                            </p>
                        </div>
                        <div class="main-item__info">

                            <div class="main-item__info-params">
                                <div class="main-item__info-params__item">
                                    <img src="{% static 'img/auto-probeg-page-1920/bak.png' %}" alt="">
                                    <p style="margin: 0 auto;">{{ car.modification.volume }} л</p>
                                </div>
                                <div class="main-item__info-params__item">
                                    <img src="{% static 'img/auto-probeg-page-1920/car-ls.png' %}" alt="">
                                    <p style="margin: 0 auto;"> {{ car.modification.power }} л.с.</p>
                                </div>
                                <div class="main-item__info-params__item">
                                    <img src="{% static 'img/auto-probeg-page-1920/kpp.png' %}" alt="">
                                    <p style="margin: 0 auto;">{{ car.modification.transmission.title }}</p>
                                </div>
                                <div class="main-item__info-params__item">
                                    <img src="{% static 'img/auto-probeg-page-1920/privod.png' %}" alt="">
                                    {% if car.modification.drive_unit %}
                                        {% for drive in car.modification.drive_unit.all %}
                                            <p style="margin: 0 auto;">{{ drive }}</p>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </div>
                            <div class="main-item__info-btns">
                                <button class="main-item__info-btns__reserve red-btn">
                                    Забронировать онлайн
                                </button>
                                <button class="main-item__info-credit">
                                    Купить в кредит
                                </button>
                            </div>
                            <div class="main-item__info-total">
                                <div class="main-item__info-total__pluses">
                                    <div class="main-item__info-total__pluses-item">
                                        <img src="{% static 'img/auto-probeg-page-1920/trade-in.png' %}" alt="">
                                        <p>Зачёт вашего авто в trade-in</p>
                                    </div>
                                    <div class="main-item__info-total__pluses-item">
                                        <img src="{% static 'img/auto-probeg-page-1920/procent.png' %}" alt="">
                                        <p>Беспроцентная рассрочка 0%</p>
                                    </div>
                                    <div class="main-item__info-total__pluses-item">
                                        <img src="{% static 'img/auto-probeg-page-1920/present.png' %}" alt="">
                                        <p>Доп. выгода до 200 000 ₽</p>
                                    </div>
                                </div>
                                <div class="main-item__info-total__desc">
                                    <p class="main-item__info-total__desc-item">
                                        Привод: {% if car.modification.drive_unit %}
                                        {% for drive in car.modification.drive_unit.all %}
                                            <span>{{ drive }}</span>
                                        {% endfor %}
                                    {% endif %}
                                    </p>
                                    <p class="main-item__info-total__desc-item">
                                        Кузов: {% if car.modification.body_type %}
                                        {% for body in car.modification.body_type.all %}
                                            <span>{{ body }}</span>
                                        {% endfor %}
                                    {% endif %}
                                    </p>
                                    <p class="main-item__info-total__desc-item">
                                        Год: <span>{{ car.modification.year }}</span>
                                    </p>
                                    <p class="main-item__info-total__desc-item">
                                        Пробег: <span>{{ car.mileage }} км.</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% if car.description %}
                    <div class="main-desc">
                        <h2 class="sec-title">
                            Описание {{ car.brand.title }} {{ car.model.title }} {{ car.generation.title }} {{ car.modification.title }}
                        </h2>
                        <p class="main-desc__desc">
                            {{ car.description }}
                        </p>
                    </div>
                {% endif %}
                <div class="main-complect">
                    <h2 class="sec-title">
                        Комплектация {{ car.brand.title }} {{ car.model.title }} {{ car.generation.title }} {{ car.modification.title }}
                    </h2>
                    <div class="main-complect__content">
                        <div class="main-complect__list">
                            <div class="main-complect__list-item">
                                <div class="main-complect__list-item__row">
                                    <p class="main-complect__list-item__row-title">
                                        Максимальная мощность двигателя(кВт) при об./мин.
                                    </p>
                                    <p class="main-complect__list-item__row-desc">
                                        {{ car.modification.power }} л.с.
                                    </p>
                                </div>
                                <div class="main-complect__list-item__row">
                                    <p class="main-complect__list-item__row-title">
                                        Тип привода:
                                    </p>
                                    <p class="main-complect__list-item__row-desc">
                                        {% if car.modification.drive_unit %}
                                            {% for drive in car.modification.drive_unit.all %}
                                                <span>{{ drive }}</span>
                                            {% endfor %}
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                            <div class="main-complect__list-item">
                                <div class="main-complect__list-item__row">
                                    <p class="main-complect__list-item__row-title">
                                        Тип трансмиссии
                                    </p>
                                    <p class="main-complect__list-item__row-desc">
                                        {{ car.modification.transmission.title }}
                                    </p>
                                </div>
                                <div class="main-complect__list-item__row">
                                    <p class="main-complect__list-item__row-title">
                                        Объем двигателя
                                    </p>
                                    <p class="main-complect__list-item__row-desc">
                                        {{ car.modification.volume.title }}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="probeg">
            <div class="container">
                {% if cars.count %}
                    <h2 class="sec-title probeg-title">
                        Автомобили с пробегом за эти же деньги
                    </h2>
                {% endif %}
                <div class="auto__list">
                    {% for car_ in cars %}
                        <div class="auto__item">
                            <div class="card" style="background-image: none;">
                                <div class="card__flex">
                                    <div class="card__title">
                                        {{ car_.brand.title }} {{ car_.model.title }} {{ car_.generation.title }} {{ car_.modification.title }}
                                    </div>
                                    <div class="card__icons">
                                        <i class="card__likes likes-icon"></i>
                                    </div>
                                </div>

                                <div class="card__flex">
                                    <a href="{% url 'detail' %}" class="owl-carousel owl-theme">
                                        {% for car_image in car_.car_images.all %}
                                            <img src="{{ car_image.image.url }}" alt="">
                                        {% endfor %}
                                    </a>
                                </div>
                                <div class="card__price card__flex">
                                    <span class=" -bold">от {{ car_.price }} &#8381</span>
                                    <div class="card__payment">
                                        Кредит
                                        <p class="-bold">от 12000 &#8381/мес.</p>
                                    </div>
                                </div>
                                <div class="card__flex card__option-list">
                                    <div class="card__option-item i-engine i-engine--m">
                                        {{ car_.modification.power }} л.с.
                                    </div>
                                    <div class="card__option-item i-gas i-gas--m">
                                        {{ car_.modification.fuel_consumption }} л/км
                                    </div>
                                    <div class="card__option-item i-speed i-speed--m">
                                        {{ car_.modification.max_speed }} км/ч
                                    </div>
                                    <div class="card__option-item i-timer i-timer--m">
                                        {{ car_.modification.acceleration }} c.
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                {% if cars.count > 8 %}
                    <div class="probeg__btn-cont">
                        <button class="probeg__more red-btn">
                            показать ещё
                        </button>
                    </div>
                {% endif %}
            </div>
        </section>
    </main>
    <script>
        $(document).ready(function () {
            $('.owl-carousel').owlCarousel({
                loop: true,
                margin: 10,
                responsiveClass: true,
                dost: false,
                responsive: {
                    0: {
                        items: 1,
                        nav: false
                    },
                    600: {
                        items: 1,
                        nav: false
                    },
                    1000: {
                        items: 1,
                        nav: false,
                        loop: false,

                    }
                }
            })
        })
    </script>
    <script defer>
        for (let e of document.querySelectorAll('input[type="range"].slider-progress')) {
            e.style.setProperty('--value', e.value);
            e.style.setProperty('--min', e.min == '' ? '0' : e.min);
            e.style.setProperty('--max', e.max == '' ? '100' : e.max);
            e.addEventListener('input', () => e.style.setProperty('--value', e.value));
        }
        // адаптация карточек максимальное количество карточек в строке 4
        let cards = document.querySelectorAll('.probeg__cards-item');
    </script>

{% endblock content %}